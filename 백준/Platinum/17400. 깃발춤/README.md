# [Platinum V] 깃발춤 - 17400 

[문제 링크](https://www.acmicpc.net/problem/17400) 

### 성능 요약

메모리: 21944 KB, 시간: 292 ms

### 분류

자료 구조, 세그먼트 트리

### 문제 설명

<p>매일 코딩만 하던 상헌이는 두뇌가 너무 코드에만 범벅이 되고 있는 것 같아 두뇌를 다른 방면으로 몰입시킬 수 있는 깃발춤 공연을 보러 가기로 했다. 깃발춤 공연은 <em>N</em>명의 공연자들이 일렬로 서서 깃발을 박력 있게 흔들며 진행된다. 깃발을 들고 있는 공연자들은 각각 카리스마의 정도 <em>c<sub>i</sub></em>를 지니고 있어, 몇몇 공연자들은 보다 절도 있게 깃발을 흔든다.</p>

<p>상헌이는 깃발춤을 보다가, 문득 깃발춤 공연 중 몇몇 연속된 공연자들이 깃발을 교대로 흔드는 것을 목격했다. 상헌이는 이를 '교대 깃발춤'이라 명명하였다. 교대 깃발춤은 <em>L</em>번째 공연자부터 <em>R</em>번째 공연자까지 깃발을 각자 왼쪽 또는 오른쪽으로 흔드는 동작인데, <em>L</em>번째 공연자를 포함하여 <em>L</em>번째 공연자과의 거리가 짝수인 공연자는 깃발을 왼쪽으로 흔들고, 거리가 홀수인 공연자는 오른쪽으로 흔든 뒤, 다시 깃발을 몸 쪽으로 원위치시킨다. 여기서 <em>x</em>번째 공연자와 <em>y</em>번째 공연자 사이의 거리는 |<em>x</em> - <em>y</em>|로 표현된다.</p>

<p>문제 해결에서 벗어날 수 없었던 상헌이는 교대 깃발춤에서 왼쪽으로 깃발을 흔든 공연자들의 카리스마의 합과 오른쪽으로 깃발을 흔든 공연자들의 카리스마의 합의 차이의 절댓값을 교대 깃발춤의 균일도라고 부르기로 하였다. 교대 깃발춤의 균일도가 큰 값을 가지면, 한쪽이 다른 쪽보다 압도적으로 카리스마가 느껴진다는 뜻이기에 비대칭적으로 보일 수 있다. 상헌이는 교대 깃발춤의 균일도가 중요한 의미를 지닌다고 생각한다. 또 깃발을 흔드는 공연자들은 공연의 열기와 순간순간의 실수에 휩쓸리기 때문에, 공연자들의 카리스마가 증가하거나 감소할 수 있다. 이런 모든 상황을 고려하며 상헌이는 매 교대 깃발춤의 균일도를 구하고 싶어졌다. 상헌이를 도와주자!</p>

### 입력 

 <p>첫 번째 줄에는 깃발춤을 진행하는 공연자의 명수인 자연수 <em>N</em>과 상황 변화의 개수인 자연수 <em>Q</em>가 공백으로 구분되어 주어진다. (1 ≤ <em>N</em> ≤ 300,000, 1 ≤ <em>Q</em> ≤ 300,000)<br>
두 번째 줄에는 정수 <em>c<sub>1</sub></em>, <em>c<sub>2</sub></em>, ..., <em>c<sub>N</sub></em> 이 공백으로 구분되어 주어지며, <em>c<sub>i</sub></em> 는 <em>i </em>번째 공연자의 카리스마를 의미한다. (-100,000 ≤ <em>c<sub>i</sub></em> ≤ 100,000)<br>
세 번째 줄부터<em> Q </em>개의 줄에 걸쳐 다음 형식 중 하나로 세 정수가 공백으로 구분되어 주어진다.<br>
- <code>1</code> <em>L</em> <em>R</em> : <em>L </em>번째 공연자부터 <em>R</em> 번째 공연자까지 구성된 교대 깃발춤이 시연된다. (1 ≤ <em>L</em> ≤ <em>R</em> ≤ <em>N</em>)<br>
- <code>2</code> <em>L</em> <em>x</em> : <em>L </em>번째 공연자의 카리스마가 정수 <em>x</em>만큼 증가한다. (1 ≤ <em>L</em> ≤ <em>N</em>, -100,000 ≤ x ≤ 100,000)<br>
첫 번째 종류('<code>1</code> <em>L</em> <em>R</em>' 꼴)의 쿼리는 한 번 이상 주어짐이 보장된다.</p>

### 출력 

 <p>첫 번째 종류의 쿼리가 입력될 때마다 매 줄에 해당하는 교대 깃발춤의 균일도를 출력한다.</p>

